{"version":3,"sources":["messages/messages-message.js"],"names":["window","Ractive","controller","component","data","el","config","done","_hideMessage","index","callback","words","Message","get","forEach","word","i","set","setTimeout","_displayMessage","message","args","length","split","map","display","out","lineCallback","displayWordTime","displayedLineCallback","freezeLastLine","displayTextTime","DISPLAY_TEXT_TIME","DISPLAY_WORD_TIME","observe","$","extend"],"mappings":"CAAA,WACE,YAEAA,QAAOC,QAAQC,WAAW,mBAAoB,SAASC,EAAWC,EAAMC,EAAIC,EAAQC,GASlF,QAASC,GAAaC,EAAOC,GAC3B,GAAc,IAAVD,EAGF,WAFAC,IAKF,IAAIC,GAAQC,EAAQC,IAAI,QAExBF,GAAMG,QAAQ,SAASC,EAAMC,GAC3BJ,EAAQK,IAAI,SAAWD,EAAI,SAAS,KAGtCE,WAAW,WACTR,KACC,KAGL,QAASS,GAAgBC,EAASX,EAAOY,GACvCb,EAAaC,EAAO,WAElB,GAAIW,EAAQE,QAAUb,EAKpB,YAJIY,EAAKX,UACPW,EAAKX,WAMT,IAAIC,GAAQS,EAAQX,GAAOc,MAAM,KAAKC,IAAI,SAAST,GACjD,OACEA,KAAMA,EACNU,SAAS,EACTC,KAAK,IAITd,GAAQK,IAAI,QAASN,GAEjBU,EAAKM,cACPN,EAAKM,aAAaf,GAGpBM,WAAW,WACTP,EAAMG,QAAQ,SAASC,EAAMC,GAE3BE,WAAW,WACTN,EAAQK,IAAI,SAAWD,EAAI,aAAa,IACvCK,EAAKO,gBAAkBZ,KAI5BE,WAAW,WAELG,EAAKQ,uBACPR,EAAKQ,sBAAsBjB,GAG7BH,IAEAS,WAAW,WACLE,EAAQE,QAAUb,GAASY,EAAKS,eAC9BT,EAAKX,UACPW,EAAKX,WAIPS,EAAgBC,EAASX,EAAOY,IAEjCA,EAAKU,kBAENV,EAAKO,gBAAkBjB,EAAMW,OAAU,SA9EjD,GAAIU,GAAoB,IACpBC,EAAoB,IAEpBrB,EAAUT,GACZC,KAAMA,GAiFRQ,GAAQsB,QAAQ,OAAQ,SAASb,GAC/BA,EAAOA,MACFA,EAAKD,UAIVC,EAAKD,QAAiC,gBAAhBC,GAAKD,SAAuBC,EAAKD,SAAWC,EAAKD,QAEvEF,WAAW,WAETG,EAAOc,EAAEC,QAAO,GACd1B,SAAU,KACViB,aAAc,KACdE,sBAAuB,KACvBE,gBAAiBC,EACjBJ,gBAAiBK,EACjBH,gBAAgB,GACfT,GAEHA,EAAKU,gBAAmBV,EAAKU,iBAA4C,IAAzBV,EAAKU,gBAA4CV,EAAKU,gBAAzBC,EAC7EX,EAAKO,gBAAmBP,EAAKO,iBAA4C,IAAzBP,EAAKO,gBAA4CP,EAAKO,gBAAzBK,EAE7Ed,EAAgBE,EAAKD,QAAS,EAAGC,QAIrCd","file":"messages/messages-message.min.js","sourcesContent":["(function() {\r\n  'use strict';\r\n\r\n  window.Ractive.controller('messages-message', function(component, data, el, config, done) {\r\n\r\n    var DISPLAY_TEXT_TIME = 3000,\r\n        DISPLAY_WORD_TIME = 150;\r\n\r\n    var Message = component({\r\n      data: data\r\n    });\r\n\r\n    function _hideMessage(index, callback) {\r\n      if (index === 0) {\r\n        callback();\r\n\r\n        return;\r\n      }\r\n\r\n      var words = Message.get('words');\r\n\r\n      words.forEach(function(word, i) {\r\n        Message.set('words[' + i + '].out', true);\r\n      });\r\n\r\n      setTimeout(function() {\r\n        callback();\r\n      }, 350);\r\n    }\r\n\r\n    function _displayMessage(message, index, args) {\r\n      _hideMessage(index, function() {\r\n\r\n        if (message.length == index) {\r\n          if (args.callback) {\r\n            args.callback();\r\n          }\r\n\r\n          return;\r\n        }\r\n\r\n        var words = message[index].split(' ').map(function(word) {\r\n          return {\r\n            word: word,\r\n            display: false,\r\n            out: false\r\n          };\r\n        });\r\n\r\n        Message.set('words', words);\r\n\r\n        if (args.lineCallback) {\r\n          args.lineCallback(Message);\r\n        }\r\n\r\n        setTimeout(function() {\r\n          words.forEach(function(word, i) {\r\n\r\n            setTimeout(function() {\r\n              Message.set('words[' + i + '].display', true);\r\n            }, args.displayWordTime * i);\r\n\r\n          });\r\n\r\n          setTimeout(function() {\r\n\r\n            if (args.displayedLineCallback) {\r\n              args.displayedLineCallback(Message);\r\n            }\r\n\r\n            index++;\r\n\r\n            setTimeout(function() {\r\n              if (message.length == index && args.freezeLastLine) {\r\n                if (args.callback) {\r\n                  args.callback();\r\n                }\r\n              }\r\n              else {\r\n                _displayMessage(message, index, args);\r\n              }\r\n            }, args.displayTextTime);\r\n\r\n          }, (args.displayWordTime * words.length) + 350);\r\n\r\n        });\r\n\r\n      });\r\n    }\r\n\r\n    Message.observe('play', function(args) {\r\n      args = args || {};\r\n      if (!args.message) {\r\n        return;\r\n      }\r\n\r\n      args.message = typeof args.message == 'string' ? [args.message] : args.message;\r\n\r\n      setTimeout(function() {\r\n\r\n        args = $.extend(true, {\r\n          callback: null,\r\n          lineCallback: null,\r\n          displayedLineCallback: null,\r\n          displayTextTime: DISPLAY_TEXT_TIME,\r\n          displayWordTime: DISPLAY_WORD_TIME,\r\n          freezeLastLine: false\r\n        }, args);\r\n\r\n        args.displayTextTime = !args.displayTextTime && args.displayTextTime !== 0 ? DISPLAY_TEXT_TIME : args.displayTextTime;\r\n        args.displayWordTime = !args.displayWordTime && args.displayWordTime !== 0 ? DISPLAY_WORD_TIME : args.displayWordTime;\r\n\r\n        _displayMessage(args.message, 0, args);\r\n      });\r\n    });\r\n\r\n    done();\r\n  });\r\n\r\n})();\r\n"],"sourceRoot":"/source/"}